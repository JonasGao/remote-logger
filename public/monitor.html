<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Demo</title>
    <link rel="stylesheet" type="text/css" href="./monitor.css" />
  </head>
  <body>
    <p id="logList"></p>
    <script src="/socket.io/socket.io.js"></script>
    <script>
      const socket = io("/monitor", {
        transports: ["websocket"]
      });
      const logList = document.getElementById("logList");
      const appendLog = data => {
        const logCode = document.createElement("code");
        const logPre = document.createElement("pre");
        logCode.appendChild(logPre);
        if (typeof data === "object") {
          if (data.app) {
            data = `[app] ${data.app} [content] ${data.content}`;
          } else {
            data = JSON.stringify(data);
          }
        }
        logPre.innerHTML = data;

        logList.appendChild(logCode);
        scrollTo(0, document.body.scrollHeight);
      };

      socket.on("log", data => {
        console.log("reciving [data]", data);
        appendLog(data);
      });
    </script>
  </body>
</html>
